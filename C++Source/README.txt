At some point the source file was rewritten to C++, not sure it it works.
